[{{:uplevel.png?direct&20|}}](contetnts_rus)
[{{:flag_rus.png?direct&20|}}](soft_studio_macro_rus)
[{{:flag_eng.png?direct&20|}}](soft_studio_macro_eng)

====== Описание работы с макроэффектами ======  

Для начала работы необходимо запустить существующий или создать новый проект. Для этого нужно ознакомиться с документом [[soft_studio_rus|Среда проектирования queen studio]]. Далее в панели инструментов главного меню выбираем {{:screen:studio-tools-macroeffects_editor.jpg?direct|}}, в результате откроется окно для работы с макроэффектами "macroeffects editor"  --- //[[romanovkolja@yandex.ru|kolya]] 2018/03/30 13:16//**Серег, в реальности там написано macroeefects**  

{{ :screen:soft-macro.jpg?direct |}}  

Главной экран программы разделен на 3 части: **macroeffects list**, **editor**, **думаю логгер но пока не знаю**, подробное описание будет ниже.

=====   macroeffects list   =====  
 
Разделен на 2 части.  
Вверху- список всех существующих макроэффектов, написано только название файлов, все они одного формата **.mef**.
Внизу- панель инструментов для взаимодействия с макроэффектами
|Инструмент     |Название     |Описание     |  
|{{ :screen:macro-tools-add_new.jpg |}}     |add new macroeffect     |создать новый макроэффект     |  
|{{ :screen:macro-tools-delete.jpg |}}     |delete macroeffect     |удалить выбранный макроэффект     |  
|{{ :screen:macro-tools-rename.jpg |}}     |rename macroeffect     |переименовать выбранный макроэффект     |  
|{{ :screen:macro-tools-refresh.jpg |}}     |refresh files     |обновить файлы, располагает файлы по алфавиту    |  

**Примечание.**  
При создании нового макроэффекта {{:screen:macro-tools-add_new.jpg|}} появится окно  
{{ :screen:macro-enter_new_macroeffect_name.jpg |}}  
необходимо ввести название нового макроэффекта,  для подтверждения нажать **Ok**, для отмены **Cancel**.  
При удалении выбранного файла {{:screen:macro-tools-delete.jpg|}} появится окно  
{{ :screen:macro-delete_file.jpg?direct |}}  
для подтверждения удаления нажать **__Y__es**, для отмены **__N__o**.  
При переименовании выбранного файла {{:screen:macro-tools-rename.jpg|}} появится окно  
{{ :screen:macro-rename_file.jpg?direct |}}  
для подтверждения нажать **__Y__es**, для отмены **__N__o**. После нажатия **__Y__es** появится окно  
{{ :screen:macro-enter_new_macroeffect_name.jpg?direct |}}
необходимо ввести название нового макроэффекта,  для подтверждения нажать **Ok**, для отмены **Cancel**.  

===== editor =====  
Разделен на 3 части.  
Вверху и внизу расположены панели инструментов, в середине выбранный макроэффект.  
**верхняя панель инструментов **
|Инструмент     |Название     |Описание     |  
|{{ :screen:macro-editor-close_current_tab.jpg? |}}|close current tab|закрывает открытый макроэффект|  
|{{ :screen:macro-editor-backup.jpg |}}|backup|сохраняет копию файла до изменения, что бы можно было вернуться к предыдущему варианту|  
|{{ :screen:studio-tools-save.jpg |}}|save|сохраняет изменения в макроэффекте|  
|{{ :screen:macro-editor-save_all.jpg |}}|save all|сохраняет изменения во всех макроэффектах|  
|{{ :screen:studio-tools-undo.jpg |}}|restore backup|загружает ранее сохранный вариант макроэффекта|  
|{{ :screen:macro-editor-open_wizard.jpg |}}|open wizard|???|  
|{{ :screen:studio-tools-run_queen_room.jpg |}}|check up errors|проверяет макроэффект на наличие ошибок|  

Примечание  
Инструмент ** close current tab** {{:screen:macro-editor-close_current_tab.jpg|}}  выводит окно сохранения  
{{ :screen:macro-editor-close-warning.jpg?direct |}}  
если файл был изменен и не сохранен. Чтобы сохранить и закрыть нажать __Y__es, чтобы не сохранить и закрыть нажать __N__o, для отмены нажать Cancel.  
Инструмент **backup** {{:screen:macro-editor-backup.jpg|}} сохраняет предыдущие версии, если стоит галочка.  
Инструменты  **save** {{:screen:studio-tools-save.jpg?direct&20|}} и **save all** {{:screen:macro-editor-save_all.jpg?direct|}} не запрашивают подтверждения, сохраняют файлы автоматически.  
Инструмент **restore backup**{{:screen:studio-tools-undo.jpg?direct&20|}}  при нажатии выводит список всех возможных (сохраненных) версий данного макроэффекта.  
  
Инструмент  **check up errors** {{:screen:studio-tools-run_queen_room.jpg?direct&20|}} выводит окно сохранения  
{{ :screen:macro-editor-close-warning_2.jpg? |}}  
  если файл был изменен и не сохранен.  Чтобы сохранить и начать проверку нажать Yes, чтобы отменить изменения и начать проверку нажать No, чтобы не сохранять изменения и начать проверку нажать Cancel.  
Далее проводится проверка файла, если ошибок нет появится окно  
{{ :screen:macro-editor-errors-n.jpg? |}}  
Нажать **OK**, чтобы продолжить.  
Если ошибка есть появится окно в котором будет номером строки с ошибкой.  
{{ :screen:macro-editor-errors-y.jpg? |}}  
В данном примере ошибка в 5 строке. Если ошибок несколько появится окно в котором будет номер верхней строки с ошибкой, по её исправлению, и повторной проверки появится следующее окно с номер строки с ошибкой и т.д.  


**Нижняя строка инструментов**  
|Инструмент     |Название     |Описание     |
|{{ :screen:macro-tools-add_new.jpg?direct |}}     |add new effect     |добавить новый эффект     |
|{{ :screen:macro-tools-delete.jpg?direct |}}     |delete effect     |удалить выбранный эффект     |
|{{ :screen:macro-editor-copy_tab.jpg?direct |}}     |cope effect    |добавить копию выбранного эффекта     |
|{{ :screen:macro-editor-unselect_all.jpg?direct |}}     |unselect all     |открепить все выделенные эффекты     |  

**Примечание**  
Для работы со всеми инструментами нижней панели необходимо выделить (кликнуть) любой эффект в средней части раздела editor.  
Инструмент **add new effect** {{:screen:macro-tools-add_new.jpg?direct&20|}} - добавляет новый эффект в макроэффект, следующим после выделенного эффекта.  
Инструмент **delete effect** {{:screen:macro-tools-delete.jpg?direct|&20}} - удаляет выделенный эффект, и делает выделенным эффект, который стоял ниже удаленного. Т.е.- если в макроэффекте 10 эффектов, выбираем 9 и удаляем его, получаем макроэффект с 9 эффектами и выделенным 9 элементом. Снова удаляем 9 элемент, получаем макроэффект с 8 эффектами и не выделенным эффектом.  
Инструмент **cope effect** {{:screen:macro-editor-copy_tab.jpg?direct&20|}} - копирует **1** выделенный эффект и добавляет его следующим после выделенного эффекта.  
Инструмент **unselect all** - (Для удобства пользователя можно выделять несколько элементов двойным кликом (подробнее ниже)), позволяет открепить все выделенные эффекты.  
  
  
**editor, средняя часть, макроэффекты**  
{{ :screen:macro-editor-center.jpg?direct |}}  
Названия макроэффектов, представленные ниже **верхней строки инструментов**, являются открытыми (16, 14, 15, 17 в данном примере). Файл который "**больше**" остальных является выбранным для изменения (16 в данном примере). Файлы  могут быть подсвечены **серым** и **красным** цветами, **серый**- файл сохранен в том виде в котором открыт (17 в данном примере), **красный**- файл сохранен в другом виде т.е. был измене и не сохранен (14, 15, 16 в данном примере).  

Макроэффект представляет из себя набор эффектов которые имеют следующие значения:
|Название|Возможность изменить вручную |Описание|
|select|нет(изменяется при смене параметра type)|графическое изображение типа объекта  |
|time|нет(зависит оп параметра offset и предыдущего значения time)|время начала эффекта|
|offset|да|изменить время|
|type|да|выбрать тип объекта|
|object|да/нет(зависит от type)|выбрать объект в комнате|
|value|да/нет (зависит от type)|величина воспроизведения|  
**Примечание**  
Столбец **select** имеет 6 изображений по 1 отдельному для типов (столбец type)- dumme, reset, out, send, 1 общий для pwm и strobo, один общий для play, volume, stop.  
Столбец **time** описывается в виде: **00:00.0** , где первые две цифры - часы, вторые две цифры - минуты, последнее число доля секунды.  
Столбец **offset**- самый первый эффект начальный **(begin)**, его время невозможно изменить, всегда 00:00.0. Далее чтобы изменять значения времени начала эффекта необходимо нажать на кнопку с волнистой линией {{:screen:macro-editor-center_offset.jpg|}}, в результате появится всплывающее окошко {{:screen:macro-editor-center_offset-var.jpg?direct|&30}}, где выбрав **offset time**, откроется окно  
{{ :screen:macro-editor-center_offset-spesify.jpg?direct |}}  
вводим время которое хотим добавить, ко времени начала эффекта, для подтверждения нажимаем Ok, для отмены Cancel. Выбрав **same time**, сбросится любые изменения, прибавка времени снова станет нулевой. **К тому же если написать неправильное время,система исправит ошибку** (в разделе с минутами написать 70 и сохранить, система автоматически сохранит, 1 час и 10 минут).  
Столбец **type**- тип объекта,в выбранном объекте, имеется стрелочка выбора типов объекта, нажав на неё получим  
{{ :screen:macro-editor-center_type.jpg?direct |}}  
далее выбираем нужный тип.  
Столбец **object**- выбор объекта управления (зависит от **type**).  
Столбец **value**- выбор велечины воспроизведения объекта управления (зависит от **type**). 
|type|object|value|описание эффекта|
|dummy|-|~|для типа "пустышка" объект выбрать нельзя, а величина воспроизведения не влияет.  |
|reset|-|-|сброс параметров комнаты|
|out|все объекты комнаты типа (type) out|off/on|двухуровневый эффект вкл\выкл (работа лампочки накаливания)|
|pwm|все объекты комнаты типа (type) pwm|0-255|многоуровневый эффект (яркость диода)|
|strobo|все объекты комнаты типа (type) pwm|no(нет)/low(низкий уровень)/high(высокий уровень)|эффект  позволяющий стробоскопить свет|
|play|все объекты звуковоспроизведения 3 варианта: back/voice/fore|указывается путь  к файлу воспроизведения|воспроизводит аудио файл|
|volume|все объекты звуковоспроизведения 3 варианта: back/voice/fore|0-100|задает уровень громкости, эффекту выбранному в play|
|stop|все объекты звуковоспроизведения 3 варианта: back/voice/fore|-|останавливает воспроизведение файла выбранного в play|
|send|объекты адаптеры |путь к файлу|воспроизводит команду адаптера|  

**Работа с функциями эффектов макроэффекта**  
Для выбора эффекта (строки) макроэффекта необходимо кликнуть по нему л.к.м. Чтобы выбрать несколько эффектов необходимо кликнуть по эффекту 2 раза, в результате он отметится * если несколько эффектов отмечены * значит они выделены *  
{{ :screen:macro-editor-chighlight_effects.jpg?direct |}}  
все действия с ними будут происходить одновременно. 
Существует 5 действий с объектами (3 всегда, 5 с объектами имеющими \* ). Кликнув по любому существующему эффекту появится окно {{:screen:macro-editor-3_actions.jpg?direct|}}, где **delete item** и **dublicate item**, тоже что и в нижней строке инструментов. **add item** представляет более широкий спектр возможностей {{:screen:macro-editor-3_actions_add.jpg?direct|}} нежили в нижней панели инструментов, так здесь есть те же функции, что и в столбце offset (**same time**, **offset time**), и функция **absolute time**- выбрав её появится окно  
{{ :screen:macro-editor-center_absolute-spesify.jpg?direct |}}  
вводим суда время начала нового эффекта.  
Два дополнительных действия появляются, если имеются 1 или более объектов со \*. В таком случае имеет место  
{{ :screen:macro-editor-5_actions.jpg?direct |}}  
где первые три функции одинаковы как для объектов без звездочки \*, так и для объектов со звездочкой \*. А две дополнительные функции позволяют скопировать, и вырезать выделенные элементы, на любой эффект (строку) макроэффекта. 
 